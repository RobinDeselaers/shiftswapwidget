<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Shift Overview</title>

<style>
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: #f6f7f8;
        padding: 20px;
    }

    .widget {
        width: 420px;
        margin: auto;
        background: #ffffff;
        border-radius: 14px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        padding: 20px;
    }

    /* Header */
    .date-range {
        text-align: center;
        font-weight: 600;
        margin-bottom: 15px;
        color: #333;
    }

    .week-days {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        font-size: 13px;
        color: #777;
    }

    .week-days div {
        width: 40px;
        text-align: center;
        padding: 6px 0;
        border-radius: 8px;
        cursor: pointer;
    }

    .week-days .active {
        background: #005eb8;
        color: white;
        font-weight: 600;
    }

    .nav-arrows {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        color: #777;
        cursor: pointer;
        font-size: 18px;
        user-select: none;
    }

    /* Summary */
    .summary {
        text-align: center;
        margin: 15px 0;
        font-weight: 600;
        color: #444;
    }

    /* Daily section */
    .day-label {
        margin-top: 20px;
        margin-bottom: 5px;
        font-weight: 600;
        color: #444;
    }

    .shift-card {
        background: white;
        padding: 12px;
        border-radius: 10px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        border-left: 4px solid #5c4cff;
        margin-bottom: 12px;
    }

    .shift-time {
        font-weight: 700;
        font-size: 15px;
        margin-bottom: 5px;
    }

    .shift-details {
        font-size: 14px;
        color: #555;
        margin-bottom: 3px;
    }

    .shift-meta {
        text-align: right;
        font-size: 13px;
        color: #777;
        margin-top: 5px;
    }

    .swap-btn {
        margin-top: 10px;
        padding: 6px 10px;
        border-radius: 6px;
        background: #005eb8;
        color: white;
        border: none;
        cursor: pointer;
    }

    .swap-btn:hover {
        background: #00468a;
    }

    /* Floating button */
    .fab {
        width: 50px;
        height: 50px;
        background: #4caf50;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 28px;
        position: fixed;
        bottom: 40px;
        right: 40px;
        cursor: pointer;
        box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    }

    /* Modal */
    .modal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.4);
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background: white;
        padding: 20px;
        width: 350px;
        border-radius: 12px;
    }

    .close {
        float: right;
        cursor: pointer;
        font-size: 20px;
    }
</style>
</head>

<body>

<div class="widget">

    <h2 style="margin-bottom: 5px;">Shift Overview</h2>

    <div class="date-range">Oct 21 – Oct 27, 2019</div>

    <div class="nav-arrows">
        <span>&lt;</span>
        <span>&gt;</span>
    </div>

    <div class="week-days">
        <div>Mo<br>21</div>
        <div class="active">Tu<br>22</div>
        <div>We<br>23</div>
        <div>Th<br>24</div>
        <div>Fr<br>25</div>
        <div>Sa<br>26</div>
        <div>Su<br>27</div>
    </div>

    <div class="summary">30 hrs / $285</div>

    <!-- Tue -->
    <div class="day-label">Tue, Oct 22</div>
    <div class="shift-card">
        <div class="shift-time">10am – 5:30pm</div>
        <div class="shift-details">Ben Bartling · Surf Instructor</div>
        <div class="shift-details">Wailea Beach</div>
        <div class="shift-meta">7.5 hrs / $71.25</div>

        <button class="swap-btn" onclick="openSwapModal('10am – 5:30pm')">Request Swap</button>
    </div>

    <!-- Wed -->
    <div class="day-label">Wed, Oct 23</div>
    <div class="shift-card">
        <div class="shift-time">10am – 5:30pm</div>
        <div class="shift-details">Ben Bartling · Beach Rentals</div>
        <div class="shift-details">Hanalei Beach</div>
        <div class="shift-meta">7.5 hrs / $71.25</div>

        <button class="swap-btn" onclick="openSwapModal('10am – 5:30pm')">Request Swap</button>
    </div>

    <!-- Thu -->
    <div class="day-label">Thu, Oct 24</div>
    <div class="shift-card">
        <div class="shift-time">10am – 5:30pm</div>
        <div class="shift-details">Ben Bartling · Surf Instructor</div>
        <div class="shift-details">Wailea Beach</div>
        <div class="shift-meta">7.5 hrs / $71.25</div>

        <button class="swap-btn" onclick="openSwapModal('10am – 5:30pm')">Request Swap</button>
    </div>

</div>

<!-- Floating add button -->
<div class="fab">+</div>

<!-- Modal -->
<div id="swapModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeSwapModal()">&times;</span>
        <h3>Request Shift Swap</h3>
        <p id="selectedShift"></p>

        <label><strong>Swap with colleague:</strong></label><br><br>
        <select id="colleague" style="width:100%;padding:8px;border-radius:6px;">
            <option value="Dr. Smith">Dr. Smith</option>
            <option value="Dr. Perez">Dr. Perez</option>
            <option value="Dr. Lee">Dr. Lee</option>
        </select>

        <br><br>
        <button class="swap-btn" onclick="sendSwapRequest()">Send Request</button>
    </div>
</div>

<script>
let chosenShift = "";

function openSwapModal(shift) {
    chosenShift = shift;
    document.getElementById("selectedShift").innerHTML =
        "<strong>Shift:</strong> " + shift;
    document.getElementById("swapModal").style.display = "flex";
}

function closeSwapModal() {
    document.getElementById("swapModal").style.display = "none";
}

// API call
async function sendSwapRequest() {
    const colleague = document.getElementById("colleague").value;

    const payload = {
        "accessorIds": ["6914bfac955bde56d791c4ee"],
        "channels": ["notificationCenter", "push"],
        "content": {
            "en_US": { "text": `New Shift Swap Requested: ${chosenShift} → ${colleague}` },
            "de_DE": { "text": `New Shift Swap Requested: ${chosenShift} → ${colleague}` }
        },
        "icon": { "en_US": {"type":"font","char":""}, "de_DE": {"type":"font","char":""} },
        "image": {
            "en_US": {
                "type":"image",
                "href":"https://i.pinimg.com/474x/66/9b/d7/669bd7e734f2e0615d94fb1af77cc6aa.jpg",
                "width":600,"height":400
            },
            "de_DE": {
                "type":"image",
                "href":"https://i.pinimg.com/474x/66/9b/d7/669bd7e734f2e0615d94fb1af77cc6aa.jpg",
                "width":600,"height":400
            }
        },
        "link": "https://app.staffbase.com/content/page/6914e3ecd5cde774c74364f1"
    };

    try {
        const res = await fetch("https://app.staffbase.com/api/branch/notifications", {
            method: "POST",
            headers: {
                "Authorization": "Basic NjkxNGM3MzA0ZWE3Y2E1NmE2MDhjOGU2Ol0ta0t3KmU2b3phVG4zeG9SK2NoQVt7KnNeTHsmIXtrSSY5TCZze3AqeWssdDJELi1Rel1PYzJ7dGx0N0h+QjQ=",
                "Content-Type": "application/json"
            },
            body: JSON.stringify(payload)
        });

        alert(res.ok ? "Shift swap request sent!" : "Error sending request.");
    } catch (e) {
        alert("Network error.");
    }

    closeSwapModal();
}
</script>

</body>
</html>
